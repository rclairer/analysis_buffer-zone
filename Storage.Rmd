---
title: "I_don't_need"
author: "Claire_Rosemond"
date: "October 11, 2016"
output: html_document
---

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r combine_seasons}
```

```{r one_site}
distance <- read.csv ("Distance/dive_pts_distance_to_other_dive_pts_ft.csv") #
distance.matrix <- as.matrix(distance[,2:4])
distance.matrix <- as.data.frame(distance.matrix)
distance.codes <-as.matrix(sites[,c(1,2,13)]) 
distance.codes <- as.data.frame(distance.codes)

library (dplyr)



#For FALL

half.species.bcd.fall <- matrix(nrow=nrow(species.bcd_df.fall), ncol=nrow(species.bcd_df.fall))
 j=1  # j is "outer loop" counter (columns); begin at 1
  for (j in 1:nrow(species.bcd_df.fall)) {
    i=1  # i is "inner loop" counter (rows)
    for (i in 1:nrow(species.bcd_df.fall)) {
      if (i<=j) {
        half.species.bcd.fall[i,j] <- "NA" # writes NA values to matrix c by row i and col j
        i=i+1
      }
      else {
        half.species.bcd.fall[i,j] <- species.bcd_df.fall[i,j] 
      }
      i=i+1
    }  
    j=j+1
  }
 
env.species.bcd.fall <- cbind(env_data.structural.fall [,1:7], half.species.bcd.fall)
env.species.bcd.fall <- as.data.frame(env.species.bcd.fall)

env.species.bcd.fall$Site <- as.character(env.species.bcd.fall$Site)
env.species.bcd.fall$Subsite <- as.character(env.species.bcd.fall$Subsite)


data <- env.species.bcd.fall # name data simply
out<-calc_bcd_dist_matrix(data=env.species.bcd.fall) # where you use the function 


# this is the function called calc_bcd_dist_matrix that puts sites and their dissimilarities and distances in a pretty matrix
calc_bcd_dist_matrix <- function(data){
site_subsite <- paste(data$Site, data$Subsite, sep = "_") # identify unique site and subsite combinations
uniq <- unique(unlist(site_subsite))  # saves unique site and subsite combinations as object called 'uniq' so that can use them in the loop below for counting purposes

# Make data frame to store results of outlier detection
results <- data.frame(site_in = character(), subsite_in = character(), id_in = character(), site_far = character(), subsite_far = character(), id_far = character(), dist = integer(), dissim = integer())

p=1 # p is the counter, initialize it at 1, represents number of uniq site and subsite combinations
  for (p in 1:length(uniq)){
    ## In site
      a <- rep(data[p,2], nrow(data)) # in site
      b <- rep(data[p,3], nrow(data)) # in subsite
      IN <- cbind(a,b)
    ## Far site
      NEAR <- data[,2:3] # always the second (site) and thrid (subsite) columns of data, just repeated, for the far
    ## Dissimilarity
      DISS <- data[,p+7] # dissimilarity value is always in the column of p + 7
    ## Combine results    
      combo <- cbind(IN, NEAR, DISS)
      results <- rbind(results, combo)
    p=p+1
    }

# if need to reset, use these two lines of code
# p <- NULL
# results <- NULL

IN <- results[,1:2]

IN <- as.data.frame(IN)
colnames(IN) <- c("Site", "Subsite")

joining1 <- join(IN, distance.codes, by = c("Site", "Subsite"))

colnames(joining1) <- c("IN_Site", "IN_Subsite", "IN_FID")
joining1$IN_FID <- as.character (joining1$IN_FID)

NEAR <- results[,3:4] 
NEAR <-as.data.frame(NEAR)
colnames(NEAR) <- c("Site", "Subsite")

joining2 <- join(NEAR, distance.codes, by = c("Site", "Subsite"))
colnames(joining2)<- c("NEAR_Site", "NEAR_Subsite", "NEAR_FID")
joining2$NEAR_FID <- as.character(joining2$NEAR_FID)

diss <- results[,5]
diss <- as.data.frame(diss) 
colnames(diss) <- "BCD"

#INhelp <- joining1[,3]
#INhelp <- as.data.frame(INhelp)
#colnames(INhelp) <- c("IN_FID")


#NEARhelp <- joining2[,3]
#NEARhelp <- as.data.frame(NEARhelp)
#colnames(NEARhelp) <- c("NEAR_FID")

#omg$IN_FID <- as.numeric(omg$IN_FID)
#omg$NEAR_FID <- as.numeric(omg$NEAR_FID)
#distance.matrix$IN_FID <- as.numeric(distance.matrix$IN_FID)
#distance.matrix$NEAR_FID <- as.numeric(distance.matrix$NEAR_FID)
#distance.matrix$NEAR_DIST <- as.character(distance.matrix$NEAR_DIST)

#omg <- cbind(INhelp, NEARhelp)
#cookie <- join(distance.matrix, omg, by = c("IN_FID", "NEAR_FID"))
#poop <- join(omg, distance.matrix, by = c("IN_FID", "NEAR_FID"))

#IN.NEAR.diss$IN_FID <- as.numeric(IN.NEAR.diss$IN_FID)
#IN.NEAR.diss$NEAR_FID <- as.numeric(IN.NEAR.diss$NEAR_FID)
distance.matrix$IN_FID <- as.numeric(distance.matrix$IN_FID)
distance.matrix$NEAR_FID <- as.numeric(distance.matrix$NEAR_FID)
distance.matrix$NEAR_DIST <- as.character(distance.matrix$NEAR_DIST)


IN.NEAR.diss <- cbind(joining1, joining2, diss)
IN.NEAR.diss$IN_FID <- as.numeric(IN.NEAR.diss$IN_FID)
IN.NEAR.diss$NEAR_FID <- as.numeric(IN.NEAR.diss$NEAR_FID)

dist.IN.NEAR.diss <- join(IN.NEAR.diss, distance.matrix, by = c ("IN_FID", "NEAR_FID"))
#dist.IN.NEAR.diss <- join(distance.matrix, IN.NEAR.diss, by = c("IN_FID", "NEAR_FID"))
#heeeelp <- filter(dist.IN.NEAR.diss, IN_Site != 'NA')
dist.IN.NEAR.diss
}

#dist.IN.NEAR.diss <- dist.IN.NEAR.diss[,c(4,5,1,6,7,2,3,8)]


#IN_dist <- join(IN, distance.codes, by =c("Site", "Subsite"))
#NEAR_dist <- join(NEAR, distance.codes, by =c("Site", "Subsite"))

#colnames(IN_dist) <- c("IN_Site", "IN_Subsite", "IN_FID")
#colnames(NEAR_dist) <- c("NEAR_Site", "NEAR_Subsite", "NEAR_FID")

#distance <- cbind(IN_dist, NEAR_dist)
#distance <- as.data.frame(distance)
#distance$IN_FID <- as.character(distance$IN_FID)
#distance$NEAR_FID <- as.character(distance$NEAR_FID)

#dist <- join(distance.matrix, distance, by = c("IN_FID", "NEAR_FID"))

#disttest <- join(distance, distance.matrix, by = c("IN_FID", "NEAR_FID"))
#final <- cbind(dist, DISS)
#colnames(final)<-c("IN_Site", "IN_Subsite", "IN_FID", "NEAR_Site", "NEAR_Subsite", "NEAR_FID", "BCD")

#final_join <- join(distance.matrix, final, by = c("IN_FID", "NEAR_FID"))


## begin outermost for loop... 
 # uniq <- unique(unlist(all_data$ID)) # generates all unique transect IDs that include site, date, sample season, transect number, unlist produces vector, unlisted to be taken into unique format, this can stay the same

#uniq <- unique(unlist(env.species.bcd.fall$ID))
#bcd.matrix <- matrix(nrow=(nrow(env.species.bcd.fall))^2, ncol=8)



bcd <- matrix(nrow=(nrow(env.species.bcd.fall))^2, ncol=8)
i=1
k = 1
#p = 1
#for (p in 1:nrow(bcd)){
for (k in 1:nrow(env.species.bcd.fall)){
  for (i in 1:nrow(bcd)){
    bcd[i,1] <- env.species.bcd.fall[k,2]
   i=i+1
  }
}
##  i=i+nrow(env.species.bcd.fall)
  k =k+1
#}  
  
#################################################################################  
bcd <- matrix(nrow=(nrow(env.species.bcd.fall))^2, ncol=8)
i = 1
k = 1
for (k in 1:(nrow(env.species.bcd.fall)-1)){
for (i in i:(i+nrow(env.species.bcd.fall))){
  bcd[i,1] <- env.species.bcd.fall[k,2]
  bcd[i,2] <- env.species.bcd.fall[k,3]
  i=i+1
}
k = k +1
}  
#####################################################

  
bcdtest <-  matrix(nrow=(nrow(env.species.bcd.fall))^2, ncol=8)


 
bcd <- matrix(nrow=(nrow(env.species.bcd.fall))^2, ncol=8)
i=1
k = 1
p = 1
for (p in 1:nrow(bcd)){
for (k in 1:nrow(env.species.bcd.fall)){
  for (i in 1:nrow(bcd)){
    bcd[p,1] <- env.species.bcd.fall[k,2]
   i=i+1
  }
}
  i=i+nrow(env.species.bcd.fall)
  k =k+1
}  
  
  
  
  
  
  
  

k=1
i=1
for (k in 1:28){
  for (i in 1:nrow(bcd)){
  bcd[i,1] <- env.species.bcd.fall[k,2]  # in site
  i=i+1
  }
k=k+1
}

  bcd[i,2] <- env.species.bcd.fall[k,3]  # in subsite

  bcd[i,3] <- env.species.bcd.fall [i,2] # near site
  bcd[i,4] <- env.species.bcd.fall [i,3] # near subsite
  joining1 <- join(bcd[,1:2], distance.codes, by = c("Site", "Subsite"))

 for (j in 1:2) {
    if (j == 1) {
    for (i in 1:nrow(env.species.bcd.fall)) {
      if (i<= nrow(env.species.bcd.fall)) {
       IN[i,j] <- env.species.bcd.fall [k,2]
        i=i+1
      }
      else {
        break
      }
      i=i+1
    }
    }
    if (j == 2){
    for (i in 1:nrow(env.species.bcd.fall)){
      if (i <= nrow(env.species.bcd.fall)) {
       IN[i,j] <- env.species.bcd.fall [k,3]
        i=i+1
      }
      else {
        break
      }
      i=i+1

    } 
    }
    
}
k = k+1



IN <- as.data.frame(IN)
colnames(IN) <- c("Site", "Subsite")

joining1 <- join(IN, distance.codes, by = c("Site", "Subsite"))

colnames(joining1) <- c("IN_Site", "IN_Subsite", "IN_FID")


 
NEAR <- matrix(nrow=nrow(env.species.bcd.fall), ncol=2)
 j=1  # j is "outer loop" counter (columns); begin at 1
for (j in 1:2) {
    i=1  # i is "inner loop" counter (rows)
    if (j == 1) {
    for (i in 1:nrow(env.species.bcd.fall)) {
      if (i<= nrow(env.species.bcd.fall)) {
       NEAR [i,j] <- env.species.bcd.fall [i,2]
        i=i+1
      }
      else {
        break
      }
      i=i+1
    }
    }
    if (j == 2){
    for (i in 1:nrow(env.species.bcd.fall)){
      if (i <= nrow(env.species.bcd.fall)) {
       NEAR [i,j] <- env.species.bcd.fall [i,3]
        i=i+1
      }
      else {
        break
      }
      i=i+1
    } 
    }
}
 
 
NEAR <-as.data.frame(NEAR)
colnames(NEAR) <- c("Site", "Subsite")

joining2 <- join(NEAR, distance.codes, by = c("Site", "Subsite"))
colnames(joining2)<- c("NEAR_Site", "NEAR_Subsite", "NEAR_FID")

env.species.bcd.fall$'1' <- as.character(env.species.bcd.fall$'1')


diss <- matrix(nrow=nrow(env.species.bcd.fall), ncol=1)
 j=1  # j is "outer loop" counter (columns); begin at 1
for (j in 1:1) {
    i=1  # i is "inner loop" counter (rows)
    for (i in 1:nrow(env.species.bcd.fall)) {
      if (i<= nrow(env.species.bcd.fall)) {
       diss[i,j] <- env.species.bcd.fall [i,8]
        i=i+1
      }
      else {
        break
      }
      i=i+1
    }
}  

diss <- as.data.frame(diss) 
colnames(diss) <- "BCD"


IN.NEAR.diss <- cbind(joining1, joining2, diss)
dist.IN.NEAR.diss <- join(distance.matrix, IN.NEAR.diss, by = c("IN_FID", "NEAR_FID"))

dist.IN.NEAR.diss <- dist.IN.NEAR.diss[,c(4,5,1,6,7,2,3,8)]

dist.IN.NEAR.diss.sofar <- filter(dist.IN.NEAR.diss, IN_Site != 'NA')
dist.IN.NEAR.diss.sofar <- filter(dist.IN.NEAR.diss, BCD != 'NA')
dist.IN.NEAR.diss.sofar$BCD <- as.character(dist.IN.NEAR.diss.sofar$BCD)
#dist.IN.NEAR.diss.sofar$BCD <- as.numeric(dist.IN.NEAR.diss.sofar$BCD)

dist.IN.NEAR.diss.sofar$NEAR_DIST <- as.numeric(dist.IN.NEAR.diss.sofar$NEAR_DIST)

dist.IN.NEAR.diss.sofar <- mutate(dist.IN.NEAR.diss.sofar, NEAR_DIST_nautical = NEAR_DIST / 6076.12)
#I should make this into nautical miles


library(ggplot2)


help = ggplot(dist.IN.NEAR.diss.sofar, aes(x=as.numeric(NEAR_DIST_nautical), y=as.numeric(BCD))) 

help + geom_point () +theme_classic () +  scale_y_continuous(name="Bray Curtis Dissimilarity", limits=c(0, 1), breaks=seq(0, 1, by=0.05)) + scale_x_continuous(name = "Distance", limits=c(0, 60), breaks=seq(0, 60,by=10))

```

```{r plotting_BCD}
dist.IN.NEAR.diss.sofar <- filter(dist.IN.NEAR.diss, IN_Site != 'NA')
dist.IN.NEAR.diss.sofar$BCD <- as.character(dist.IN.NEAR.diss.sofar$BCD)
dist.IN.NEAR.diss.sofar$BCD <- as.numeric(dist.IN.NEAR.diss.sofar$BCD)

dist.IN.NEAR.diss.sofar$NEAR_DIST <- as.numeric(dist.IN.NEAR.diss.sofar$NEAR_DIST)

dist.IN.NEAR.diss.sofar <- mutate(dist.IN.NEAR.diss.sofar, NEAR_DIST_nautical = NEAR_DIST / 6076.12)
#I should make this into nautical miles


library(ggplot2)


help = ggplot(dist.IN.NEAR.diss.sofar, aes(x=as.numeric(NEAR_DIST_nautical), y=as.numeric(BCD))) 

help + geom_point () +theme_classic () +  scale_y_continuous(name="Bray Curtis Dissimilarity", limits=c(0, 1), breaks=seq(0, 1, by=0.05)) + scale_x_continuous(name = "Distance", limits=c(0, 60), breaks=seq(0, 60,by=10))


```

```{r prep_for_BCD_function}

library(ecodist)
library(vegan)
library(ggplot2)

structural.data <- filter(data, Transect_Type == "Structural")
fall.structural.data <- filter(structural.data, Sampling_Period == "Fall")


fall.MHC.data <- filter(fall.structural.data, Site == "330" | Site == "345")


env.end<- 29 #FOR SPECEIS
sp.start<-30 #FOR SPECIES

env_data.fall.MHC <- fall.MHC.data [,1:env.end]

 
species.data.fall.MHC <-fall.MHC.data [,sp.start:ncol(fall.MHC.data)] # fish data

species.transform.fall.MHC <- transform_data (data = species.data.fall.MHC, transform_type = "cube_root")

set.seed(318) # for reproducibility
species.bcd.fall.MHC<-bcdist(species.transform.fall.MHC, rmzero=FALSE) # build distance matrix based on bray curtis

species.bcd.fall.MHC <- as.matrix(species.bcd.fall.MHC)
                   

fall.MHC <- matrix(nrow=nrow(species.bcd.fall.MHC), ncol=nrow(species.bcd.fall.MHC))
 j=1  # j is "outer loop" counter (columns); begin at 1
  for (j in 1:nrow(species.bcd.fall.MHC)) {
    i=1  # i is "inner loop" counter (rows)
    for (i in 1:nrow(species.bcd.fall.MHC)) {
      if (i<=j) {
        fall.MHC[i,j] <- "NA" # writes NA values to matrix c by row i and col j
        i=i+1
      }
      else {
        fall.MHC[i,j] <- species.bcd.fall.MHC[i,j] 
      }
      i=i+1
    }  
    j=j+1
  }
 
env.fall.MHC <- cbind(env_data.fall.MHC [,1:7], fall.MHC)
env.fall.MHC <- as.data.frame(env.fall.MHC)

env.fall.MHC$Site <- as.character(env.fall.MHC$Site)
env.fall.MHC$Subsite <- as.character(env.fall.MHC$Subsite)


data <- fall.MHC.data # name data simply
site_subsite <- paste(data$Site, data$Subsite, sep = "_") # identify unique site and subsite combinations
uniq <- unique(unlist(site_subsite))  # saves unique site and subsite combinations as object called 'uniq' so that can use them in the loop below for counting purposes

# Make data frame to store results of outlier detection
results <- data.frame(site_in = character(), subsite_in = character(), id_in = character(), site_far = character(), subsite_far = character(), id_far = character(), dist = integer(), dissim = integer())

p=1 # p is the counter, initialize it at 1, represents number of uniq site and subsite combinations
  for (p in 1:length(uniq)){
    ## In site
      a <- rep(data[p,2], nrow(data)) # in site
      b <- rep(data[p,3], nrow(data)) # in subsite
      IN <- cbind(a,b)
    ## Far site
      NEAR <- data[,2:3] # always the second (site) and thrid (subsite) columns of data, just repeated, for the far
    ## Dissimilarity
      DISS <- data[,p+7] # dissimilarity value is always in the column of p + 7
    ## Combine results    
      combo <- cbind(IN, NEAR, DISS)
      results <- rbind(results, combo)
    p=p+1
    }

# if need to reset, use these two lines of code
# p <- NULL
# results <- NULL

IN <- results[,1:2]

IN <- as.data.frame(IN)
colnames(IN) <- c("Site", "Subsite")

joining1 <- join(IN, distance.codes, by = c("Site", "Subsite"))

colnames(joining1) <- c("IN_Site", "IN_Subsite", "IN_FID")
joining1$IN_FID <- as.character (joining1$IN_FID)

NEAR <- results[,3:4] 
NEAR <-as.data.frame(NEAR)
colnames(NEAR) <- c("Site", "Subsite")

joining2 <- join(NEAR, distance.codes, by = c("Site", "Subsite"))
colnames(joining2)<- c("NEAR_Site", "NEAR_Subsite", "NEAR_FID")
joining2$NEAR_FID <- as.character(joining2$NEAR_FID)

diss <- results[,5]
diss <- as.data.frame(diss) 
colnames(diss) <- "BCD"

#INhelp <- joining1[,3]
#INhelp <- as.data.frame(INhelp)
#colnames(INhelp) <- c("IN_FID")


#NEARhelp <- joining2[,3]
#NEARhelp <- as.data.frame(NEARhelp)
#colnames(NEARhelp) <- c("NEAR_FID")

#omg$IN_FID <- as.numeric(omg$IN_FID)
#omg$NEAR_FID <- as.numeric(omg$NEAR_FID)
#distance.matrix$IN_FID <- as.numeric(distance.matrix$IN_FID)
#distance.matrix$NEAR_FID <- as.numeric(distance.matrix$NEAR_FID)
#distance.matrix$NEAR_DIST <- as.character(distance.matrix$NEAR_DIST)

#omg <- cbind(INhelp, NEARhelp)
#cookie <- join(distance.matrix, omg, by = c("IN_FID", "NEAR_FID"))
#poop <- join(omg, distance.matrix, by = c("IN_FID", "NEAR_FID"))

IN.NEAR.diss$IN_FID <- as.numeric(IN.NEAR.diss$IN_FID)
IN.NEAR.diss$NEAR_FID <- as.numeric(IN.NEAR.diss$NEAR_FID)
distance.matrix$IN_FID <- as.numeric(distance.matrix$IN_FID)
distance.matrix$NEAR_FID <- as.numeric(distance.matrix$NEAR_FID)
distance.matrix$NEAR_DIST <- as.character(distance.matrix$NEAR_DIST)


IN.NEAR.diss <- cbind(joining1, joining2, diss)
dist.IN.NEAR.diss <- join(IN.NEAR.diss, distance.matrix, by = c ("IN_FID", "NEAR_FID"))
#dist.IN.NEAR.diss <- join(distance.matrix, IN.NEAR.diss, by = c("IN_FID", "NEAR_FID"))
#heeeelp <- filter(dist.IN.NEAR.diss, IN_Site != 'NA')

#dist.IN.NEAR.diss <- dist.IN.NEAR.diss[,c(4,5,1,6,7,2,3,8)]


#IN_dist <- join(IN, distance.codes, by =c("Site", "Subsite"))
#NEAR_dist <- join(NEAR, distance.codes, by =c("Site", "Subsite"))

#colnames(IN_dist) <- c("IN_Site", "IN_Subsite", "IN_FID")
#colnames(NEAR_dist) <- c("NEAR_Site", "NEAR_Subsite", "NEAR_FID")

#distance <- cbind(IN_dist, NEAR_dist)
#distance <- as.data.frame(distance)
#distance$IN_FID <- as.character(distance$IN_FID)
#distance$NEAR_FID <- as.character(distance$NEAR_FID)

dist.IN.NEAR.diss.sofar <- filter(dist.IN.NEAR.diss, IN_Site != 'NA')
dist.IN.NEAR.diss.sofar$BCD <- as.character(dist.IN.NEAR.diss.sofar$BCD)
dist.IN.NEAR.diss.sofar$BCD <- as.numeric(dist.IN.NEAR.diss.sofar$BCD)

dist.IN.NEAR.diss.sofar$NEAR_DIST <- as.numeric(dist.IN.NEAR.diss.sofar$NEAR_DIST)

dist.IN.NEAR.diss.sofar <- mutate(dist.IN.NEAR.diss.sofar, NEAR_DIST_nautical = NEAR_DIST / 6076.12)
#I should make this into nautical miles


library(ggplot2)


help = ggplot(dist.IN.NEAR.diss.sofar, aes(x=as.numeric(NEAR_DIST_nautical), y=as.numeric(BCD))) 

help + geom_point () +theme_classic () +  scale_y_continuous(name="Bray Curtis Dissimilarity", limits=c(0, 1), breaks=seq(0, 1, by=0.05)) + scale_x_continuous(name = "Distance", limits=c(0, 10), breaks=seq(0, 60,by=1))


```

```{r mega_matrix}
 
distance <- read.csv ("Distance/dive_pts_distance_to_other_dive_pts_ft.csv") #
distance.matrix <- as.matrix(distance[,2:4])
distance.matrix <- as.data.frame(distance.matrix)
distance.codes <-as.matrix(sites[,c(1,2,13)]) 
distance.codes <- as.data.frame(distance.codes)

library (dplyr)


#For FALL

half.species.bcd.fall <- matrix(nrow=nrow(species.bcd_df.fall), ncol=nrow(species.bcd_df.fall))
 j=1  # j is "outer loop" counter (columns); begin at 1
  for (j in 1:nrow(species.bcd_df.fall)) {
    i=1  # i is "inner loop" counter (rows)
    for (i in 1:nrow(species.bcd_df.fall)) {
      if (i<=j) {
        half.species.bcd.fall[i,j] <- "NA" # writes NA values to matrix c by row i and col j
        i=i+1
      }
      else {
        half.species.bcd.fall[i,j] <- species.bcd_df.fall[i,j] 
      }
      i=i+1
    }  
    j=j+1
  }
 
env.species.bcd.fall <- cbind(env_data.structural.fall [,1:7], half.species.bcd.fall)
env.species.bcd.fall <- as.data.frame(env.species.bcd.fall)

env.species.bcd.fall$Site <- as.character(env.species.bcd.fall$Site)
env.species.bcd.fall$Subsite <- as.character(env.species.bcd.fall$Subsite)


purplegreenbeans <- matrix(nrow=784, ncol=2)
k=1
for(k in 1:nrow(env.species.bcd.fall)){
 j=1  # j is "outer loop" counter (columns); begin at 1
 for (j in 1:2) {
    i=1  # i is "inner loop" counter (rows)
    if (j == 1) {
    for (i in 1:nrow(env.species.bcd.fall)) {
      if (i<= nrow(env.species.bcd.fall)) {
       purplegreenbeans[i,j] <- env.species.bcd.fall [k,2]
        i=i+1
      }
      else {
        break
      }
      i=i+1
    }
    }
    
    if (j == 2){
    for (i in 1:nrow(env.species.bcd.fall)){
      if (i <= nrow(env.species.bcd.fall)) {
       purplegreenbeans[i,j] <- env.species.bcd.fall [k,3]
        i=i+1
      }
      else {
        break
      }
      i=i+1
    } 
    }
 }
k = k+1
}



IN <- matrix(nrow=nrow(env.species.bcd.fall), ncol=2)
 j=1  # j is "outer loop" counter (columns); begin at 1
for (j in 1:2) {
    i=1  # i is "inner loop" counter (rows)
    if (j == 1) {
    for (i in 1:nrow(env.species.bcd.fall)) {
      if (i<= nrow(env.species.bcd.fall)) {
       IN[i,j] <- env.species.bcd.fall [1,2]
        i=i+1
      }
      else {
        break
      }
      i=i+1
    }
    }
    if (j == 2){
    for (i in 1:nrow(env.species.bcd.fall)){
      if (i <= nrow(env.species.bcd.fall)) {
       IN[i,j] <- env.species.bcd.fall [1,3]
        i=i+1
      }
      else {
        break
      }
      i=i+1
    } 
    }
}

IN <- as.data.frame(IN)
colnames(IN) <- c("Site", "Subsite")

joining1 <- join(IN, distance.codes, by = c("Site", "Subsite"))

colnames(joining1) <- c("IN_Site", "IN_Subsite", "IN_FID")


 
NEAR <- matrix(nrow=nrow(env.species.bcd.fall), ncol=2)
 j=1  # j is "outer loop" counter (columns); begin at 1
for (j in 1:2) {
    i=1  # i is "inner loop" counter (rows)
    if (j == 1) {
    for (i in 1:nrow(env.species.bcd.fall)) {
      if (i<= nrow(env.species.bcd.fall)) {
       NEAR [i,j] <- env.species.bcd.fall [i,2]
        i=i+1
      }
      else {
        break
      }
      i=i+1
    }
    }
    if (j == 2){
    for (i in 1:nrow(env.species.bcd.fall)){
      if (i <= nrow(env.species.bcd.fall)) {
       NEAR [i,j] <- env.species.bcd.fall [i,3]
        i=i+1
      }
      else {
        break
      }
      i=i+1
    } 
    }
}
 
 
NEAR <-as.data.frame(NEAR)
colnames(NEAR) <- c("Site", "Subsite")

joining2 <- join(NEAR, distance.codes, by = c("Site", "Subsite"))
colnames(joining2)<- c("NEAR_Site", "NEAR_Subsite", "NEAR_FID")

env.species.bcd.fall$'1' <- as.character(env.species.bcd.fall$'1')


diss <- matrix(nrow=nrow(env.species.bcd.fall), ncol=1)
 j=1  # j is "outer loop" counter (columns); begin at 1
for (j in 1:1) {
    i=1  # i is "inner loop" counter (rows)
    for (i in 1:nrow(env.species.bcd.fall)) {
      if (i<= nrow(env.species.bcd.fall)) {
       diss[i,j] <- env.species.bcd.fall [i,8]
        i=i+1
      }
      else {
        break
      }
      i=i+1
    }
}  

diss <- as.data.frame(diss) 
colnames(diss) <- "BCD"


IN.NEAR.diss <- cbind(joining1, joining2, diss)
dist.IN.NEAR.diss <- join(distance.matrix, IN.NEAR.diss, by = c("IN_FID", "NEAR_FID"))

dist.IN.NEAR.diss <- dist.IN.NEAR.diss[,c(4,5,1,6,7,2,3,8)]

dist.IN.NEAR.diss.sofar <- filter(dist.IN.NEAR.diss, IN_Site != 'NA')
dist.IN.NEAR.diss.sofar$BCD <- as.character(dist.IN.NEAR.diss.sofar$BCD)
dist.IN.NEAR.diss.sofar$BCD <- as.numeric(dist.IN.NEAR.diss.sofar$BCD)

dist.IN.NEAR.diss.sofar$NEAR_DIST <- as.numeric(dist.IN.NEAR.diss.sofar$NEAR_DIST)

dist.IN.NEAR.diss.sofar <- mutate(dist.IN.NEAR.diss.sofar, NEAR_DIST_nautical = NEAR_DIST / 6076.12)
#I should make this into nautical miles


library(ggplot2)


help = ggplot(dist.IN.NEAR.diss.sofar, aes(x=as.numeric(NEAR_DIST_nautical), y=as.numeric(BCD))) 

help + geom_point () +theme_classic () +  scale_y_continuous(name="Bray Curtis Dissimilarity", limits=c(0, 1), breaks=seq(0, 1, by=0.05)) + scale_x_continuous(name = "Distance", limits=c(0, 60), breaks=seq(0, 60,by=10))


```


```{r}
summary(cars)
```

You can also embed plots, for example:

```{r, echo=FALSE}
plot(cars)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
