biom <- rowSums (species.data.biom, na.rm = FALSE, dims = 1) # totaal biomass for each sample
comm_mets <- cbind (abund, biom, S, shan, simp, simp_inv, J, env_data)
comm_mets
calc_comm_metrics()
View(comm_mets)
fishbiomass <- mutate(databiom, Biomass = rowSums(data[,30:ncol(databiom)]))
View(fishbiomass)
fishbiomass <- mutate(databiom, Biomass = rowSums(data[,30:ncol(databiom)]))
fishabundance$Transect_Number <- as.factor(fishabundance$Transect_Number)
fishabundance$Site <- as.factor(fishabundance$Site)
fishbiomass$Transect_Number <- as.factor(fishbiomass$Transect_Number)
fishbiomass$Site <- as.factor(fishbiomass$Site)
library(agricolae)
out.biomass <- lm(Biomass ~ Transect_Number, data = fishbiomass)
anova(out.biomass)
summary(out.biomass)
hsdbiom <- HSD.test(out.biomass, c("Transect_Number"))
hsdbiom
out.biomass2 <- lm(Biomass ~ Transect_Number * Sampling_Period, data = fishbiomass)
anova(out.biomass2)
summary(out.biomass2)
hsdbiom2 <- HSD.test(out.biomass2, c("Transect_Number", "Sampling_Period"))
hsdbiom2
mod2 <- lm(Abundance ~ Sampling_Period* Transect_Number, data = fishabundance)
anova(mod2)
summary(mod2)
fishabundance <- mutate(data, Abundance = rowSums(data[,30:ncol(data)]))
mod2 <- lm(Abundance ~ Sampling_Period* Transect_Number, data = fishabundance)
anova(mod2)
summary(mod2)
hsd2.samp <- HSD.test(mod2, c("Sampling_Period", "Transect_Number"))
hsd2.samp
out.biomass2 <- lm(Biomass ~ Transect_Number * Sampling_Period, data = fishbiomass)
anova(out.biomass2)
summary(out.biomass2)
hsdbiom2 <- HSD.test(out.biomass2, c("Transect_Number", "Sampling_Period"))
hsdbiom2
fishbiomass
fishabundance
out.biomass <- lm(Biomass ~ Transect_Number, data = fishbiomass)
anova(out.biomass)
summary(out.biomass)
hsdbiom <- HSD.test(out.biomass, c("Transect_Number"))
hsdbiom
hsd <- HSD.test(out.abudance, c("Transect_Number"))
hsd
out.abudance <- lm(Abundance ~ Transect_Number, data = fishabundance)
anova(out.abudance)
summary(out.abudance)
hsd <- HSD.test(out.abudance, c("Transect_Number"))
hsd
hsdbiom <- HSD.test(out.biomass, c("Transect_Number"))
hsdbiom
View(databiom)
View(data)
View(databiom)
fishbiomass <- mutate(databiom, Biomass = rowSums(databiom[,30:ncol(databiom)]))
out.biomass <- lm(Biomass ~ Transect_Number, data = fishbiomass)
anova(out.biomass)
summary(out.biomass)
hsdbiom <- HSD.test(out.biomass, c("Transect_Number"))
hsdbiom
out.biomass2 <- lm(Biomass ~ Transect_Number * Sampling_Period, data = fishbiomass)
anova(out.biomass2)
summary(out.biomass2)
hsdbiom2 <- HSD.test(out.biomass2, c("Transect_Number", "Sampling_Period"))
hsdbiom2
mod11biom <- lm(Biomass ~ Transect_Number*Reef_Type, data = fishbiomass)
anova(mod11biom)
summary(mod11biom)
library(agricolae)
hsd11.reef.biom <- HSD.test(mod11biom, c("Transect_Number", "Reef_Type"))
hsd11.reef.biom
mod13biom <- lm(Biomass ~ Reef_Type, data = fishbiomass)
anova(mod13biom)
summary(mod13biom)
library(agricolae)
hsd13.reef.biom <- HSD.test(mod13biom, c("Reef_Type"))
hsd13.reef.biom
S <- specnumber(species.orig) # species richness (S)
shan <- diversity (species.orig, index = "shannon") # shannon diversity
simp <- diversity (species.orig, index = "simpson") # simpson's diversity
simp_inv <- diversity (species.orig, index = "invsimpson") # inverse simpson's diversity
J <- shan / log (S) # pielou's evenness (J)
abund <- rowSums (species.orig, na.rm = FALSE, dims = 1) # total abundance for each sample
biom <- rowSums (species.orig.biom, na.rm = FALSE, dims = 1) # totaal biomass for each sample
comm_mets <- cbind (abund, biom, S, shan, simp, simp_inv, J, env_data)
View(comm_mets)
out.S <- lm(S ~ Transect_Number, data = comm_mets)
out.S <- lm(S ~ Transect_Number, data = comm_mets)
anova(out.S)
summary(out.S)
hsdS <- HSD.test(out.S, c("Transect_Number"))
hsdS
out.shan <- lm(shan ~ Transect_Number, data = comm_mets)
anova(out.shan)
summary(out.shan)
hsdshan <- HSD.test(out.shan, c("Transect_Number"))
hsdshan
View(data)
View(fish_meta)
everything <- lm(Abundance ~ Transect_Number * Sampling_Period * Site * Reef_Type, data = fishabundance)
anova(everything)
summary(everything)
everything <- lm(Abundance ~ Transect_Number * Sampling_Period * Site * Reef_Type * DRR * Latitude_DD * Temp_min, data = fishabundance)
anova(everything)
library(ggplot2)
fishabundance <- mutate(data, Abundance = rowSums(data[,30:ncol(data)]))
#test <- summarySE(fishabundance, measurevar = "Abundance", groupvars = c("Transect_Number", "Sampling_Period"))
test <- summarySE(fishabundance, measurevar = "Abundance", groupvars = c("Transect_Number"))
ggplot(test, aes(x=as.factor(Transect_Number), y=Abundance)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=Abundance-se, ymax=Abundance+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Average Fish Abundance",
limits=c(0, 500),
breaks=seq(0, 500,by=100)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Structure", labels = c("0" = "Structure", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Fish Abundance by Distance from Structure")+
annotate("text", x = 1, y = 460, label = "a", size = 5)+
annotate("text", x = 2, y = 180, label = "b", size = 5)+
annotate("text", x = 3, y = 63, label = "b", size = 5)+
annotate("text", x = 4, y = 27, label = "b", size = 5)
testbiom <- summarySE(fishbiomass, measurevar = "Biomass", groupvars = c("Transect_Number"))
ggplot(testbiom, aes(x=as.factor(Transect_Number), y=Biomass)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=Biomass-se, ymax=Biomass+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Average Fish Biomass",
limits=c(0, 500),
breaks=seq(0, 500,by=100)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Structure", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Fish Abundance by Distance from Reef")
ggplot(testbiom, aes(x=as.factor(Transect_Number), y=Biomass)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=Biomass-se, ymax=Biomass+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Average Fish Biomass",
limits=c(0, 50),
breaks=seq(0, 50,by=100)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Structure", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Fish Abundance by Distance from Reef")
ggplot(testbiom, aes(x=as.factor(Transect_Number), y=Biomass)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=Biomass-se, ymax=Biomass+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Average Fish Biomass",
limits=c(0, 50),
breaks=seq(0, 50,by=10)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Structure", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Fish Abundance by Distance from Reef")
ggplot(testbiom, aes(x=as.factor(Transect_Number), y=Biomass)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=Biomass-se, ymax=Biomass+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Average Fish Biomass",
limits=c(0, 50),
breaks=seq(0, 50,by=10)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Structure", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Fish Abundance by Distance from Reef")+
annotate("text", x = 1, y = 43, label = "a", size = 5)+
annotate("text", x = 2, y = 9, label = "b", size = 5)+
annotate("text", x = 3, y = 5, label = "b", size = 5)+
annotate("text", x = 4, y = 3, label = "b", size = 5)
ggplot(testbiom, aes(x=as.factor(Transect_Number), y=Biomass)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=Biomass-se, ymax=Biomass+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Average Fish Biomass",
limits=c(0, 50),
breaks=seq(0, 50,by=10)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Structure", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Fish Abundance by Distance from Reef")+
annotate("text", x = 1, y = 43, label = "a", size = 5)+
annotate("text", x = 2, y = 9, label = "b", size = 5)+
annotate("text", x = 3, y = 5, label = "b", size = 5)+
annotate("text", x = 4, y = 4, label = "b", size = 5)
ggplot(testbiom, aes(x=as.factor(Transect_Number), y=Biomass)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=Biomass-se, ymax=Biomass+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Average Fish Biomass (kg/m2)",
limits=c(0, 50),
breaks=seq(0, 50,by=10)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Structure", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Fish Abundance by Distance from Reef")+
annotate("text", x = 1, y = 43, label = "a", size = 5)+
annotate("text", x = 2, y = 9, label = "b", size = 5)+
annotate("text", x = 3, y = 5, label = "b", size = 5)+
annotate("text", x = 4, y = 4, label = "b", size = 5)
testshan <- summarySE(comm_mets, measurevar = "shan", groupvars = c("Transect_Number"))
View(testshan)
ggplot(testshan, aes(x=as.factor(Transect_Number), y=shan)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=Biomass-se, ymax=Biomass+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Shannon's Diversity Index",
limits=c(0, 50),
breaks=seq(0, 50,by=10)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Structure", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Shannon's Diversity Index by Distance from Reef")
ggplot(testshan, aes(x=as.factor(Transect_Number), y=shan)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=shan-se, ymax=shan+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Shannon's Diversity Index",
limits=c(0, 50),
breaks=seq(0, 50,by=10)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Structure", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Shannon's Diversity Index by Distance from Reef")
ggplot(testshan, aes(x=as.factor(Transect_Number), y=shan)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=shan-se, ymax=shan+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Shannon's Diversity Index",
limits=c(0, 5),
breaks=seq(0, 5,by=1)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Structure", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Shannon's Diversity Index by Distance from Reef")
ggplot(testshan, aes(x=as.factor(Transect_Number), y=shan)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=shan-se, ymax=shan+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Shannon's Diversity Index",
limits=c(0, 2),
breaks=seq(0, 2,by=0.2)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Structure", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Shannon's Diversity Index by Distance from Reef")
ggplot(testshan, aes(x=as.factor(Transect_Number), y=shan)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=shan-se, ymax=shan+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Shannon's Diversity Index",
limits=c(0, 2),
breaks=seq(0, 2,by=0.2)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Reef", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Shannon's Diversity Index by Distance from Reef")
ggplot(testshan, aes(x=as.factor(Transect_Number), y=shan)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=shan-se, ymax=shan+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Shannon's Diversity Index",
limits=c(0, 1.2),
breaks=seq(0, 1.2,by=0.2)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Reef", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Shannon's Diversity Index by Distance from Reef")
out.shan <- lm(shan ~ Transect_Number, data = comm_mets)
anova(out.shan)
summary(out.shan)
hsdshan <- HSD.test(out.shan, c("Transect_Number"))
hsdshan
ggplot(testshan, aes(x=as.factor(Transect_Number), y=shan)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=shan-se, ymax=shan+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Shannon's Diversity Index",
limits=c(0, 1.2),
breaks=seq(0, 1.2,by=0.2)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Reef", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Shannon's Diversity Index by Distance from Reef")+
annotate("text", x = 1, y = 1.2, label = "a", size = 5)+
annotate("text", x = 2, y = 0.45, label = "b", size = 5)+
annotate("text", x = 3, y = 0.25, label = "c", size = 5)+
annotate("text", x = 4, y = 0.3, label = "bc", size = 5)
ggplot(testshan, aes(x=as.factor(Transect_Number), y=shan)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=shan-se, ymax=shan+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Shannon's Diversity Index",
limits=c(0, 1.2),
breaks=seq(0, 1.2,by=0.2)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Reef", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Shannon's Diversity Index by Distance from Reef")+
annotate("text", x = 1, y = 1.17, label = "a", size = 5)+
annotate("text", x = 2, y = 0.45, label = "b", size = 5)+
annotate("text", x = 3, y = 0.25, label = "c", size = 5)+
annotate("text", x = 4, y = 0.3, label = "bc", size = 5)
ggplot(testS, aes(x=as.factor(Transect_Number), y=S)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=S-se, ymax=S+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Species Richness",
limits=c(0, 50),
breaks=seq(0, 50,by=10)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Reef", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Species Richness by Distance from Reef")
testS <- summarySE(comm_mets, measurevar = "S", groupvars = c("Transect_Number"))
View(testS)
ggplot(testS, aes(x=as.factor(Transect_Number), y=S)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=S-se, ymax=S+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Species Richness",
limits=c(0, 20),
breaks=seq(0, 20,by=10)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Reef", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Species Richness by Distance from Reef")
ggplot(testS, aes(x=as.factor(Transect_Number), y=S)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=S-se, ymax=S+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Species Richness",
limits=c(0, 10),
breaks=seq(0, 10,by=2)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Reef", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Species Richness by Distance from Reef")
out.S <- lm(S ~ Transect_Number, data = comm_mets)
anova(out.S)
summary(out.S)
hsdS <- HSD.test(out.S, c("Transect_Number"))
hsdS
ggplot(testS, aes(x=as.factor(Transect_Number), y=S)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=S-se, ymax=S+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Species Richness",
limits=c(0, 9),
breaks=seq(0, 9,by=2)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Reef", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Species Richness by Distance from Reef")+
annotate("text", x = 1, y = 8.5, label = "a", size = 5)+
annotate("text", x = 2, y = 3, label = "b", size = 5)+
annotate("text", x = 3, y = 1.5, label = "c", size = 5)+
annotate("text", x = 4, y = 1.5, label = "c", size = 5)
out.J <- lm(J ~ Transect_Number, data = comm_mets)
anova(out.J)
summary(out.J)
hsdJ <- HSD.test(out.J, c("Transect_Number"))
hsdJ
out.simp <- lm(simp ~ Transect_Number, data = comm_mets)
anova(out.simp)
summary(out.simp)
hsdsimp <- HSD.test(out.simp, c("Transect_Number"))
hsdsimp
#INVERSE SIMPSON'S DIVERSITY
out.invsimp <- lm(simp_inv ~ Transect_Number, data = comm_mets)
anova(out.invsimp)
summary(out.invsimp)
hsdinvsimp <- HSD.test(out.invsimp, c("Transect_Number"))
hsdinvsimp
test <- summarySE(fishabundance, measurevar = "Abundance", groupvars = c("Transect_Number"))
ggplot(test, aes(x=as.factor(Transect_Number), y=Abundance)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=Abundance-se, ymax=Abundance+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Average Fish Abundance",
limits=c(0, 500),
breaks=seq(0, 500,by=100)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Reef", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Fish Abundance by Distance from Reef")+
annotate("text", x = 1, y = 460, label = "a", size = 5)+
annotate("text", x = 2, y = 180, label = "b", size = 5)+
annotate("text", x = 3, y = 63, label = "b", size = 5)+
annotate("text", x = 4, y = 27, label = "b", size = 5)
ggplot(testbiom, aes(x=as.factor(Transect_Number), y=Biomass)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=Biomass-se, ymax=Biomass+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Average Fish Biomass (kg/m2)",
limits=c(0, 50),
breaks=seq(0, 50,by=10)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Reef", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Fish Biomass by Distance from Reef")+
annotate("text", x = 1, y = 43, label = "a", size = 5)+
annotate("text", x = 2, y = 9, label = "b", size = 5)+
annotate("text", x = 3, y = 5, label = "b", size = 5)+
annotate("text", x = 4, y = 4, label = "b", size = 5)
ggplot(testbiom, aes(x=as.factor(Transect_Number), y=Biomass)) +
theme_classic()+
geom_bar(position=position_dodge(), stat="identity", colour="black")+
geom_errorbar(aes(ymin=Biomass-se, ymax=Biomass+se), width=.2, position=position_dodge(0.9))+
scale_y_continuous(name="Average Fish Biomass (kg/m2)",
limits=c(0, 45),
breaks=seq(0, 45,by=10)) +
theme(axis.text=element_text(size=16, colour="black"),
axis.title.x=element_text(size=16, colour="black", vjust=-.5),
axis.title.y=element_text(size=16, colour="black", vjust=1.3),
legend.position="none",
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))+
scale_x_discrete(name = "Distance from Reef", labels = c("0" = "Reef", "1" = "0-30 m", "2" = "30-60 m", "3" = "60-90 m"))+
ggtitle("Fish Biomass by Distance from Reef")+
annotate("text", x = 1, y = 43, label = "a", size = 5)+
annotate("text", x = 2, y = 9, label = "b", size = 5)+
annotate("text", x = 3, y = 5, label = "b", size = 5)+
annotate("text", x = 4, y = 4, label = "b", size = 5)
